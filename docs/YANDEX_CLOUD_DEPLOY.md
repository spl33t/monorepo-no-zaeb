# –î–µ–ø–ª–æ–π –≤ Yandex Cloud —á–µ—Ä–µ–∑ GitHub Actions

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –∏ –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ Yandex Cloud.

## üìã –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã GitHub

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã –¥–æ–±–∞–≤—å—Ç–µ –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ **GitHub ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions**:

| –°–µ–∫—Ä–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
|--------|----------|------------------|
| `YC_SA_JSON_CREDENTIALS` | JSON-–∫–ª—é—á Service Account (–≤–µ—Å—å —Ñ–∞–π–ª `key.json`) | –í—Å–µ workflows |
| `YC_REGISTRY` | ID Container Registry (–Ω–∞–ø—Ä–∏–º–µ—Ä, `crpbtn6g41fq6gtf271j`) | –°–±–æ—Ä–∫–∞ –∏ –¥–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `YC_FOLDER_ID` | ID –ø–∞–ø–∫–∏ Yandex Cloud | –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, Object Storage |
| `YC_SERVICE_ACCOUNT_ID` | ID Service Account –¥–ª—è VM | –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `YC_NETWORK_ID` | ID –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ | –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |
| `YC_SUBNET_ID` | ID –ø–æ–¥—Å–µ—Ç–∏ | –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã:**
- `YC_SA_JSON_CREDENTIALS`: Cloud IAM ‚Üí –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚Üí –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á ‚Üí JSON
- `YC_REGISTRY`: Container Registry ‚Üí ID —Ä–µ–µ—Å—Ç—Ä–∞
- `YC_FOLDER_ID`: URL –ø–∞–ø–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ (—á–∞—Å—Ç—å –ø–æ—Å–ª–µ `/folders/`)
- `YC_SERVICE_ACCOUNT_ID`: Cloud IAM ‚Üí –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚Üí ID
- `YC_NETWORK_ID`: VPC ‚Üí –°–µ—Ç–∏ ‚Üí ID —Å–µ—Ç–∏
- `YC_SUBNET_ID`: VPC ‚Üí –°–µ—Ç–∏ ‚Üí –ü–æ–¥—Å–µ—Ç–∏ ‚Üí ID –ø–æ–¥—Å–µ—Ç–∏

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 1. Container Registry
- ‚úÖ –°–æ–∑–¥–∞—Ç—å —Ä–µ–µ—Å—Ç—Ä
- ‚úÖ –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å `admin` –∏–ª–∏ `container-registry.images.pusher` –¥–ª—è Service Account

### 2. Service Account
- ‚úÖ –°–æ–∑–¥–∞—Ç—å Service Account
- ‚úÖ –°–æ–∑–¥–∞—Ç—å JSON-–∫–ª—é—á ‚Üí –ø–æ–ª—É—á–∏—Ç—å `YC_SA_JSON_CREDENTIALS`
- ‚úÖ –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª–∏ –Ω–∞ –ø–∞–ø–∫–µ: `compute.admin`, `vpc.admin`, `iam.serviceAccounts.user`, `storage.admin`

### 3. VPC
- ‚úÖ –°–æ–∑–¥–∞—Ç—å —Å–µ—Ç—å ‚Üí –ø–æ–ª—É—á–∏—Ç—å `YC_NETWORK_ID`
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –ø–æ–¥—Å–µ—Ç—å –≤ –∑–æ–Ω–µ `ru-central1-a` ‚Üí –ø–æ–ª—É—á–∏—Ç—å `YC_SUBNET_ID`

### 4. Object Storage (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–ø—É–±–ª–∏—á–Ω—ã–π)
- ‚úÖ –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üì¶ Pipeline 1: –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤

**Workflow:** `.github/workflows/docker-build-push.yml`

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
- –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü—É—à–∏—Ç –æ–±—Ä–∞–∑ –≤ Yandex Container Registry
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SHA –∫–æ–º–º–∏—Ç–∞ –∫–∞–∫ —Ç–µ–≥ (–∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–µ–≥)

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **Actions** ‚Üí **Build and Push Docker Image** ‚Üí **Run workflow**
2. –£–∫–∞–∂–∏—Ç–µ:
   - `app_name`: –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ `apps/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `backend`)
   - `image_tag`: (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–µ–≥, –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
cr.yandex/<YC_REGISTRY>/<app_name>:<tag>
```

### –¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `YC_SA_JSON_CREDENTIALS`
- `YC_REGISTRY`

### –¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞ Service Account:
- `container-registry.images.pusher` –∏–ª–∏ `admin` –Ω–∞ Container Registry

---

## üñ•Ô∏è Pipeline 2: –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ Instance Group

**Workflow:** `.github/workflows/deploy-instance-group.yml`

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
- –°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç Instance Group
- –î–µ–ø–ª–æ–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ Container Registry
- –í—ã–ø–æ–ª–Ω—è–µ—Ç **rolling update** —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –¥–∞—É–Ω—Ç–∞–π–º–æ–º

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Rolling Update:

–ü—Ä–∏ –¥–µ–ø–ª–æ–µ Instance Group –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å—ã **–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ**, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞—É–Ω—Ç–∞–π–º:

**–¢–µ–∫—É—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `instance-group-spec.yaml`:**
```yaml
deploy_policy:
  max_unavailable: 1    # –ú–∞–∫—Å–∏–º—É–º 1 –∏–Ω—Å—Ç–∞–Ω—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
  max_expansion: 1      # –ú–∞–∫—Å–∏–º—É–º 1 –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
  max_deleting: 1       # –ú–∞–∫—Å–∏–º—É–º 1 –∏–Ω—Å—Ç–∞–Ω—Å —É–¥–∞–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
  max_creating: 1      # –ú–∞–∫—Å–∏–º—É–º 1 –∏–Ω—Å—Ç–∞–Ω—Å —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
  startup_duration: 60s # –í—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
1. –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å —Å –Ω–æ–≤—ã–º –æ–±—Ä–∞–∑–æ–º
2. –ù–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –ø—Ä–æ—Ö–æ–¥–∏—Ç health check
3. –°—Ç–∞—Ä—ã–π –∏–Ω—Å—Ç–∞–Ω—Å —É–¥–∞–ª—è–µ—Ç—Å—è
4. –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∞—É–Ω—Ç–∞–π–º (–≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–∏–Ω–∏–º—É–º 1 –∏–Ω—Å—Ç–∞–Ω—Å)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Å—Ç–∞—Ä—ã–π –æ—Å—Ç–∞–µ—Ç—Å—è)
- ‚úÖ Health checks –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º

### üîÑ Autohealing (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)

Instance Group –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –Ω–µ–∑–¥–æ—Ä–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ health checks.

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. Health check –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å –∫–∞–∂–¥—ã–µ `interval` —Å–µ–∫—É–Ω–¥
2. –ï—Å–ª–∏ –∏–Ω—Å—Ç–∞–Ω—Å –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç health check `unhealthy_threshold` —Ä–∞–∑ –ø–æ–¥—Ä—è–¥, –æ–Ω –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ `unhealthy`
3. **Autohealing –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
   - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–∑–¥–æ—Ä–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å
   - –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è –∑–∞–º–µ–Ω—ã
   - –ñ–¥–µ—Ç, –ø–æ–∫–∞ –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –ø—Ä–æ–π–¥–µ—Ç health check
4. –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å —Ç–æ–∂–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç health check

**–í–∞–∂–Ω–æ:**
- Autohealing –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ `health_checks_spec`
- –ï—Å–ª–∏ health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –∏–Ω—Å—Ç–∞–Ω—Å—ã –±—É–¥—É—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è

**–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç, –ø–æ—á–µ–º—É –∏–Ω—Å—Ç–∞–Ω—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "stopped":**
- –ò–Ω—Å—Ç–∞–Ω—Å –Ω–µ –ø—Ä–æ—à–µ–ª health check
- Autohealing –æ—Å—Ç–∞–Ω–æ–≤–∏–ª –µ–≥–æ
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è –∑–∞–º–µ–Ω—ã
- –ï—Å–ª–∏ –Ω–æ–≤—ã–π —Ç–æ–∂–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç health check, –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: –ò–Ω—Å—Ç–∞–Ω—Å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "stopped"

–ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "stopped", —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç**, –∏ **autohealing –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å—ã**.

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ‚ùå Health check endpoint `/health` –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –±—ç–∫–µ–Ω–¥–µ
2. ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3333
3. ‚ùå Health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏–ª–∏ –ø–∞–¥–∞–µ—Ç)
4. ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ health check
5. ‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ `localhost` –≤–º–µ—Å—Ç–æ `0.0.0.0`

**–†–µ—à–µ–Ω–∏–µ:**

**1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å health check endpoint –≤ –±—ç–∫–µ–Ω–¥–µ:**

**Express.js:**
```javascript
app.get('/health', (req, res) => {
  res.status(200).json({ status: 'ok' });
});
```

**NestJS:**
```typescript
@Get('health')
health() {
  return { status: 'ok' };
}
```

**FastAPI (Python):**
```python
@app.get("/health")
def health():
    return {"status": "ok"}
```

**2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3333:**

–í `docker-compose.yaml` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:
```yaml
environment:
  PORT: "3333"
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–ª—É—à–∞–µ—Ç –Ω–∞ `0.0.0.0`:
```javascript
const PORT = process.env.PORT || 3333;
// ‚ö†Ô∏è –í–ê–ñ–ù–û: —Å–ª—É—à–∞—Ç—å –Ω–∞ 0.0.0.0, –∞ –Ω–µ localhost!
app.listen(Number(PORT), '0.0.0.0', () => {
  console.log(`Server running on port ${PORT}`);
});
```

**–ü–æ—á–µ–º—É `0.0.0.0`?**
- Health check –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑–≤–Ω–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `localhost` –∏–ª–∏ `127.0.0.1` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `0.0.0.0` –¥–µ–ª–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏–∑–≤–Ω–µ

**3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞:**

–í –∫–æ–Ω—Å–æ–ª–∏ Yandex Cloud:
- Instance Group ‚Üí –ò–Ω—Å—Ç–∞–Ω—Å—ã ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç–∞–Ω—Å
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç

**4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å health check –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**

–¢–µ–∫—É—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `instance-group-spec.yaml`:
```yaml
health_checks_spec:
  health_check_specs:
    - interval: 10s           # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
      timeout: 5s             # –¢–∞–π–º–∞—É—Ç 5 —Å–µ–∫—É–Ω–¥
      unhealthy_threshold: 3  # –ü–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ - unhealthy
      healthy_threshold: 2    # –ü–æ—Å–ª–µ 2 —É—Å–ø–µ—à–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ - healthy
      http_options:
        port: 3333
        path: /health
  max_checking_health_duration: 60s  # –ú–∞–∫—Å–∏–º—É–º 60 —Å–µ–∫—É–Ω–¥ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
```

**–ï—Å–ª–∏ health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç:**
- Instance Group –ø–æ–º–µ—á–∞–µ—Ç –∏–Ω—Å—Ç–∞–Ω—Å –∫–∞–∫ `unhealthy`
- –ò–Ω—Å—Ç–∞–Ω—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è –∑–∞–º–µ–Ω—ã

**–í–∞–∂–Ω–æ –¥–ª—è Container Optimized Image (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Yandex Cloud):**

1. **Health check –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –ø–æ—Ä—Ç—É –Ω–∞ —É—Ä–æ–≤–Ω–µ VM:**
   - Health check –∏–¥–µ—Ç –Ω–∞–ø—Ä—è–º—É—é –∫ –ø–æ—Ä—Ç—É –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (–Ω–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É)
   - –ü–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ–±—Ä–æ—à–µ–Ω –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ VM
   - –í Container Optimized Image –ø–æ—Ä—Ç—ã –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ `EXPOSE` –≤ Dockerfile
   - –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ `ports` –≤ docker-compose –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å

2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–ª—É—à–∞—Ç—å –Ω–∞ `0.0.0.0`:**
   - `localhost` –∏–ª–∏ `127.0.0.1` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   - `0.0.0.0` –¥–µ–ª–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã–º –∏–∑–≤–Ω–µ –¥–ª—è health checks

3. **Health check endpoint –¥–æ–ª–∂–µ–Ω:**
   - –í–æ–∑–≤—Ä–∞—â–∞—Ç—å HTTP 200 —Å—Ç–∞—Ç—É—Å
   - –û—Ç–≤–µ—á–∞—Ç—å –±—ã—Å—Ç—Ä–æ (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö timeout 5-10 —Å–µ–∫—É–Ω–¥)
   - –ë—ã—Ç—å –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–º (–Ω–µ –Ω–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Yandex Cloud):**
- `interval: 10s-30s` - –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–æ–∫
- `timeout: 5s-10s` - —Ç–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞  
- `unhealthy_threshold: 3-5` - –ø–æ—Ä–æ–≥ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `healthy_threshold: 2-3` - –ø–æ—Ä–æ–≥ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- `startup_duration: 60s-120s` - –≤—Ä–µ–º—è –Ω–∞ –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ health check –≤—Ä—É—á–Ω—É—é:**
```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∏–Ω—Å—Ç–∞–Ω—Å—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ
curl http://localhost:3333/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"ok"} –∏–ª–∏ 200 OK
```

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å health check:**

–ï—Å–ª–∏ health check –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç (`failed http :3333 /health`), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–±—Ä–∞–∑ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏–ª–∏ `0.0.0.0`), –æ–±—Ä–∞–∑ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å!

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow **Build and Push Docker Image** —Å –≤–∞—à–∏–º `app_name`
2. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ workflow **Deploy to Instance Group** —Å —Ç–µ–º –∂–µ `app_name` –∏ –Ω–æ–≤—ã–º `image_tag`

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞

**üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –ª–æ–≥–æ–≤ –≤ Yandex Cloud Console:**

#### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–≥–∏ —á–µ—Ä–µ–∑ Instance Group (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Yandex Cloud Console:**
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.cloud.yandex.ru/
   - –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç

2. **–ù–∞–π–¥–∏—Ç–µ Instance Group:**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **Compute Cloud** (–∏–ª–∏ **–û–±–ª–∞—á–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**)
   - –í –ø–æ–¥–º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **Instance Groups** (–∏–ª–∏ **–ì—Ä—É–ø–ø—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω**)
   - –ù–∞–π–¥–∏—Ç–µ –≤–∞—à—É –≥—Ä—É–ø–ø—É (–æ–±—ã—á–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `backend-ig` –∏–ª–∏ –ø–æ—Ö–æ–∂–µ–µ)
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã

3. **–û—Ç–∫—Ä–æ–π—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤:**
   - –í –æ—Ç–∫—Ä—ã–≤—à–µ–π—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **–ò–Ω—Å—Ç–∞–Ω—Å—ã** (Instances)
   - –í—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –≤ –≥—Ä—É–ø–ø–µ
   - –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–π –∏–Ω—Å—Ç–∞–Ω—Å (–æ–±—ã—á–Ω–æ –æ–Ω –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ `unhealthy` –∏–ª–∏ `stopped`)

4. **–û—Ç–∫—Ä–æ–π—Ç–µ —Å–µ—Ä–∏–π–Ω—É—é –∫–æ–Ω—Å–æ–ª—å:**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞ (–∏–ª–∏ –Ω–∞ —Å—Ç—Ä–æ–∫—É —Å –∏–Ω—Å—Ç–∞–Ω—Å–æ–º)
   - –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **–°–µ—Ä–∏–π–Ω–∞—è –∫–æ–Ω—Å–æ–ª—å** (Serial console)
   - ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –í Yandex Cloud –Ω–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ VM!
   - –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–∏–π–Ω—É—é –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º

5. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–π–Ω—É—é –∫–æ–Ω—Å–æ–ª—å:**
   - –í —Å–µ—Ä–∏–π–Ω–æ–π –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:
   ```bash
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
   docker ps
   
   # –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
   docker logs $(docker ps -q)
   
   # –ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker-compose:
   docker-compose logs app
   
   # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check
   curl http://localhost:3333/health
   ```

**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ª–æ–≥–∞—Ö:**
```
üöÄ backend is running!
‚úÖ Server is running on http://0.0.0.0:3333
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏:**
- `Error: Cannot find module` - –ø—Ä–æ–±–ª–µ–º–∞ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- `EADDRINUSE` - –ø–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç
- `ECONNREFUSED` - –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–µ–º—É —Å–µ—Ä–≤–∏—Å—É
- `Cannot connect to database` - –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–≥–∏ —á–µ—Ä–µ–∑ Cloud Logging (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Cloud Logging:**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **Cloud Logging** (–∏–ª–∏ **–õ–æ–≥–∏**)
   - –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –ø–∞–ø–∫—É (folder)

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã:**
   - –í –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –≤–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–Ω—Å—Ç–∞–Ω—Å–∞ –∏–ª–∏ –≥—Ä—É–ø–ø—ã
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω
   - –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –ø–æ —É—Ä–æ–≤–Ω—é –ª–æ–≥–æ–≤ (ERROR, WARN, INFO)

3. **–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:**
   - –õ–æ–≥–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
   - –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

#### –í–∞—Ä–∏–∞–Ω—Ç 3: –õ–æ–≥–∏ —á–µ—Ä–µ–∑ Cloud Monitoring

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Cloud Monitoring:**
   - –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ **Monitoring** (–∏–ª–∏ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**)
   - –í—ã–±–µ—Ä–∏—Ç–µ **Dashboards** –∏–ª–∏ **Metrics**

2. **–ù–∞–π–¥–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞:**
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É Instance Group
   - –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ health check
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

**üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã:**

- **–ï—Å–ª–∏ –Ω–µ –≤–∏–¥–∏—Ç–µ –ª–æ–≥–∏:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ docker-compose.yaml
- **–ï—Å–ª–∏ –ª–æ–≥–∏ –ø—É—Å—Ç—ã–µ:** –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—â–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –∏–ª–∏ —É–ø–∞–ª–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- **–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (—Å–º. –®–∞–≥ 3)

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —á–µ—Ä–µ–∑ Yandex Cloud CLI

**–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Yandex Cloud CLI (`yc`):**

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
yc config set folder-id <–≤–∞—à-folder-id>

# 2. –ù–∞–π–¥–∏—Ç–µ ID –≤–∞—à–µ–π Instance Group
yc compute instance-group list

# 3. –ù–∞–π–¥–∏—Ç–µ ID –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞
yc compute instance-group list-instances <–∏–º—è-–≥—Ä—É–ø–ø—ã>

# 4. –ü–æ–ª—É—á–∏—Ç–µ –ª–æ–≥–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ Cloud Logging
# (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Cloud Logging)

# 5. –ò–ª–∏ –ø–æ–ª—É—á–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç–∞—Ç—É—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞
yc compute instance get <id-–∏–Ω—Å—Ç–∞–Ω—Å–∞>
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—Ä—è–º–æ–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —á–µ—Ä–µ–∑ CLI –æ–≥—Ä–∞–Ω–∏—á–µ–Ω. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ SSH.

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SSH (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø)

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –î–ª—è SSH –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –∫–ª—é—á–∏ –≤ Instance Group –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏.

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –∏–Ω—Å—Ç–∞–Ω—Å—É —á–µ—Ä–µ–∑ SSH
# –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ –≤–Ω–µ—à–Ω–∏–π IP –∏–Ω—Å—Ç–∞–Ω—Å–∞ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏
ssh <user>@<external-ip>

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω
docker ps
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –≤–∞—à–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs $(docker ps -q)
# –ò–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker-compose:
docker-compose logs app

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker exec $(docker ps -q) wget -qO- http://localhost:3333/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"ok"}

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ health check —Å —É—Ä–æ–≤–Ω—è VM (–∫–∞–∫ –¥–µ–ª–∞–µ—Ç Instance Group)
curl http://localhost:3333/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"status":"ok"}

# 6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç —Å–ª—É—à–∞–µ—Ç—Å—è –Ω–∞ 0.0.0.0
netstat -tlnp | grep 3333
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 0.0.0.0:3333 (–Ω–µ 127.0.0.1:3333)

# 7. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker inspect $(docker ps -q) | grep -A 20 "Env"
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å: HOST=0.0.0.0, PORT=3333
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `docker-compose.yaml`:**
- `HOST: "0.0.0.0"` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `PORT: "3333"` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- `ports: "3333:3333"` —É–∫–∞–∑–∞–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏)

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `instance-group-spec.yaml`:**
- `startup_duration: 90s` - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –∑–∞–ø—É—Å–∫
- `unhealthy_threshold: 5` - –Ω–µ —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ
- `http_options.port: 3333` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç
- `http_options.path: /health` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å

### –®–∞–≥ 6: –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**–ï—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ **Build and Push Docker Image**
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ **Deploy to Instance Group** —Å –Ω–æ–≤—ã–º —Ç–µ–≥–æ–º

**–ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ï—Å–ª–∏ health check –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –£–≤–µ–ª–∏—á—å—Ç–µ `startup_duration` –¥–æ `120s`
- –£–≤–µ–ª–∏—á—å—Ç–µ `timeout` –¥–æ `10s`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª—É—à–∞–µ—Ç –Ω–∞ `0.0.0.0` (–Ω–µ `localhost`)

**–ï—Å–ª–∏ –ø–æ—Ä—Ç –Ω–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Dockerfile –µ—Å—Ç—å `EXPOSE 3333`
- –í Container Optimized Image –ø–æ—Ä—Ç—ã –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:**
```yaml
deploy_policy:
  max_unavailable: 2    # –í—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
  max_expansion: 2      # –í—Å–µ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å—Ä–∞–∑—É
  max_deleting: 2       # –í—Å–µ —Å—Ç–∞—Ä—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É
  max_creating: 2      # –í—Å–µ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å—Ä–∞–∑—É
```
‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ–ª–Ω–æ–º—É –¥–∞—É–Ω—Ç–∞–π–º—É –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è!

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **Actions** ‚Üí **Deploy to Instance Group** ‚Üí **Run workflow**
2. –£–∫–∞–∂–∏—Ç–µ:
   - `app_name`: –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `backend`)
   - `image_tag`: —Ç–µ–≥ –æ–±—Ä–∞–∑–∞ –¥–ª—è –¥–µ–ø–ª–æ—è (–∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è SHA)

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
- Instance Group —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ IP –∞–¥—Ä–µ—Å–∞–º –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –∏–ª–∏ —á–µ—Ä–µ–∑ Load Balancer

### –°–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º:

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω—Å—Ç–∞–Ω—Å—ã –≤ Instance Group –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ Object Storage –Ω–µ –º–æ–∂–µ—Ç –¥–æ –Ω–∏—Ö –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è.

**–†–µ—à–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –±—ç–∫–µ–Ω–¥—É –æ–¥–Ω–∏–º –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Load Balancer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–æ–¥–∏–Ω IP/–¥–æ–º–µ–Ω)
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- Health checks –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ—Ä–∞–±–æ—á–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

1. **–°–æ–∑–¥–∞—Ç—å Load Balancer –≤ –∫–æ–Ω—Å–æ–ª–∏:**
   - Network Load Balancer ‚Üí –°–æ–∑–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
   - –¢–∏–ø: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–ª–∏ –í–Ω–µ—à–Ω–∏–π (–¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
   - –°–æ–∑–¥–∞—Ç—å Target Group –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ Instance Group

2. **–ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ `instance-group-spec.yaml`:**
   ```yaml
   load_balancer_spec:
     target_group_spec:
       name: {{ env.APP_NAME }}-tg
       target_group_labels:
         app: {{ env.APP_NAME }}
   ```

3. **–ü–æ–ª—É—á–∏—Ç—å IP –∞–¥—Ä–µ—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∞** –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
   ```javascript
   const API_URL = 'http://<LOAD_BALANCER_IP>:3333';
   // –∏–ª–∏
   const API_URL = 'https://api.yourdomain.com';
   ```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—É–±–ª–∏—á–Ω—ã–π IP –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –∫–∞–∂–¥–æ–º—É –∏–Ω—Å—Ç–∞–Ω—Å—É

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ù–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- –ü—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ IP –º–µ–Ω—è–µ—Ç—Å—è
- –ù—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

–í `instance-group-spec.yaml` –¥–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π IP:
```yaml
network_interface_specs:
  - network_id: {{ env.YC_NETWORK_ID }}
    subnet_ids:
      - {{ env.YC_SUBNET_ID }}
    primary_v4_address_spec:
      one_to_one_nat_spec:
        ip_version: IPV4
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:**
```javascript
// –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å IP –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
const API_URL = 'http://<INSTANCE_PUBLIC_IP>:3333';
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: NAT Gateway (–¥–ª—è –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

–ï—Å–ª–∏ –±—ç–∫–µ–Ω–¥ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞—Ä—É–∂—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫ –≤–Ω–µ—à–Ω–∏–º API), –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è NAT Gateway –¥–ª—è –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ Object Storage –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CORS:

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Express.js:**
```javascript
const cors = require('cors');

app.use(cors({
  origin: [
    'https://storage.yandexcloud.net',
    'https://your-cdn-domain.com',
    'http://localhost:5173' // –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
  ],
  credentials: true
}));
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤:**
- –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ `Access-Control-Allow-Origin` –≤ –æ—Ç–≤–µ—Ç–∞—Ö API
- –£–∫–∞–∂–∏—Ç–µ –¥–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö

### –¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `YC_SA_JSON_CREDENTIALS`
- `YC_REGISTRY`
- `YC_FOLDER_ID`
- `YC_SERVICE_ACCOUNT_ID`
- `YC_NETWORK_ID`
- `YC_SUBNET_ID`

### –¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞ Service Account:
- `compute.admin` –Ω–∞ –ø–∞–ø–∫–µ
- `vpc.admin` –Ω–∞ –ø–∞–ø–∫–µ
- `iam.serviceAccounts.user` –Ω–∞ –ø–∞–ø–∫–µ

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `.github/instance-group-spec.yaml` ‚Äî —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è Instance Group
- `.github/user-data.yaml` ‚Äî —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `.github/docker-compose.yaml` ‚Äî docker-compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üñ•Ô∏è Pipeline 3: –î–µ–ø–ª–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ VM

**Workflow:** `.github/workflows/deploy-vm.yml`

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
- –°–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
- –î–µ–ø–ª–æ–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–∑ Container Registry

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **Actions** ‚Üí **Deploy to VM** ‚Üí **Run workflow**
2. –£–∫–∞–∂–∏—Ç–µ:
   - `app_name`: –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - `image_tag`: —Ç–µ–≥ –æ–±—Ä–∞–∑–∞ (–∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º)

### –¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `YC_SA_JSON_CREDENTIALS`
- `YC_REGISTRY`
- `YC_FOLDER_ID`
- `YC_SERVICE_ACCOUNT_ID`
- `YC_SUBNET_ID`

### –¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞ Service Account:
- `compute.admin` –Ω–∞ –ø–∞–ø–∫–µ
- `vpc.admin` –Ω–∞ –ø–∞–ø–∫–µ
- `iam.serviceAccounts.user` –Ω–∞ –ø–∞–ø–∫–µ

---

## üé® Pipeline 4: –î–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤ Object Storage

**Workflow:** `.github/workflows/deploy-frontend-s3.yml`

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
- –°–æ–±–∏—Ä–∞–µ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (SPA)
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –≤ Object Storage
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥ –¥–ª—è SPA —Ä–æ—É—Ç–∏–Ω–≥–∞

### –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **Actions** ‚Üí **Deploy Frontend to Object Storage** ‚Üí **Run workflow**
2. –£–∫–∞–∂–∏—Ç–µ:
   - `app_name`: –∏–º—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `html`)
   - `bucket_name`: –∏–º—è –±–∞–∫–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `mv-dating`)
   - `build_command`: –∫–æ–º–∞–Ω–¥–∞ —Å–±–æ—Ä–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `npm run build`)
   - `build_output`: –ø–∞–ø–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `dist`)

### –†–µ–∑—É–ª—å—Ç–∞—Ç:
```
https://storage.yandexcloud.net/<bucket_name>/
```

### –¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
- `YC_SA_JSON_CREDENTIALS`

### –¢—Ä–µ–±—É–µ–º—ã–µ –ø—Ä–∞–≤–∞ Service Account:
- `storage.admin` –Ω–∞ –ø–∞–ø–∫–µ –∏–ª–∏ –±–∞–∫–µ—Ç–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∫–µ—Ç–∞:

**1. –°–æ–∑–¥–∞—Ç—å –±–∞–∫–µ—Ç:**
- –ò–º—è: `mv-dating` (–∏–ª–∏ –¥—Ä—É–≥–æ–µ)
- –¢–∏–ø –¥–æ—Å—Ç—É–ø–∞: **–ü—É–±–ª–∏—á–Ω—ã–π** (–¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥–∞)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Ö–æ—Å—Ç–∏–Ω–≥:**
- Object Storage ‚Üí –ë–∞–∫–µ—Ç ‚Üí –í–µ–±-—Å–∞–π—Ç
- –í–∫–ª—é—á–∏—Ç—å "–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–µ–±-—Å–∞–π—Ç"
- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `index.html`
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—à–∏–±–∫–∏: `index.html` (–¥–ª—è SPA)

**3. –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ –¥–æ—Å—Ç—É–ø–Ω—ã (403 –æ—à–∏–±–∫–∞):**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∫–µ—Ç –∏–º–µ–µ—Ç **–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø**
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ ACL: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ ‚Üí –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Üí –ß—Ç–µ–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É:
- ‚úÖ SPA (React, Vue, Angular –∏ —Ç.–¥.)
- ‚úÖ –ü–∞–ø–∫–∞ —Å–±–æ—Ä–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ (`dist`, `build`, `out`)
- ‚úÖ –§–∞–π–ª `index.html` –≤ –∫–æ—Ä–Ω–µ

---

## üåê –°–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: –§—Ä–æ–Ω—Ç–µ–Ω–¥ ‚Üî –ë—ç–∫–µ–Ω–¥

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–§—Ä–æ–Ω—Ç–µ–Ω–¥ (Object Storage)
  ‚Üì HTTP –∑–∞–ø—Ä–æ—Å—ã
Load Balancer / –ü—É–±–ª–∏—á–Ω—ã–π IP
  ‚Üì
Instance Group (–ë—ç–∫–µ–Ω–¥)
```

### –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω—Å—Ç–∞–Ω—Å—ã –≤ Instance Group –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ **–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞** –≤ VPC. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ Object Storage –Ω–µ –º–æ–∂–µ—Ç –¥–æ –Ω–∏—Ö –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é.

### –†–µ—à–µ–Ω–∏–µ: –í–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Load Balancer (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) ‚≠ê

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–æ–¥–∏–Ω IP/–¥–æ–º–µ–Ω)
- ‚úÖ –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏
- ‚úÖ Health checks –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ—Ä–∞–±–æ—á–∏—Ö –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- ‚úÖ SSL/TLS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω—ã–π IP –∞–¥—Ä–µ—Å

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å (–≤—Ä—É—á–Ω—É—é –≤ –∫–æ–Ω—Å–æ–ª–∏):**

**–®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å Target Group**

1. –û—Ç–∫—Ä–æ–π—Ç–µ [–∫–æ–Ω—Å–æ–ª—å Yandex Cloud](https://console.cloud.yandex.ru/)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Network Load Balancer** ‚Üí **Target Groups**
3. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —É–∑–ª–æ–≤"**
4. –£–∫–∞–∂–∏—Ç–µ:
   - **–ò–º—è**: `backend-tg` (–∏–ª–∏ –¥—Ä—É–≥–æ–µ)
   - **–¢–∏–ø**: Instance Group
   - **Instance Group**: –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É Instance Group (–Ω–∞–ø—Ä–∏–º–µ—Ä, `backend-ig`)
   - **Health check**:
     - –¢–∏–ø: HTTP
     - –ü–æ—Ä—Ç: `3333`
     - –ü—É—Ç—å: `/health` (–∏–ª–∏ –≤–∞—à health check endpoint)
     - –ò–Ω—Ç–µ—Ä–≤–∞–ª: `10s`
     - –¢–∞–π–º–∞—É—Ç: `5s`
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

**–®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å Load Balancer**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Network Load Balancer** ‚Üí **–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–∏**
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫"**
3. –£–∫–∞–∂–∏—Ç–µ:
   - **–ò–º—è**: `backend-lb` (–∏–ª–∏ –¥—Ä—É–≥–æ–µ)
   - **–¢–∏–ø**: **–í–Ω–µ—à–Ω–∏–π** (–¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)
   - **–°–µ—Ç—å**: –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É —Å–µ—Ç—å (`YC_NETWORK_ID`)
4. –ù–∞–∂–º–∏—Ç–µ **"–î–æ–±–∞–≤–∏—Ç—å listener"**:
   - **–ò–º—è**: `http-listener`
   - **–ü–æ—Ä—Ç**: `3333` (–∏–ª–∏ –≤–∞—à –ø–æ—Ä—Ç API)
   - **–ü—Ä–æ—Ç–æ–∫–æ–ª**: TCP –∏–ª–∏ HTTP
   - **Target Group**: –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—É—é Target Group
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

**–®–∞–≥ 3: –ü–æ–ª—É—á–∏—Ç—å IP –∞–¥—Ä–µ—Å**

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Load Balancer
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **IP –∞–¥—Ä–µ—Å** (–±—É–¥–µ—Ç –≤ —Ä–∞–∑–¥–µ–ª–µ "–û–±–∑–æ—Ä")
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
   ```javascript
   // –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
   const API_URL = 'http://<LOAD_BALANCER_IP>:3333';
   // –∏–ª–∏ —Å –¥–æ–º–µ–Ω–æ–º
   const API_URL = 'https://api.yourdomain.com';
   ```

**–®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å DNS (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

1. –í –≤–∞—à–µ–º DNS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ A-–∑–∞–ø–∏—Å—å:
   - –ò–º—è: `api` (–∏–ª–∏ –¥—Ä—É–≥–æ–µ)
   - –ó–Ω–∞—á–µ–Ω–∏–µ: IP –∞–¥—Ä–µ—Å Load Balancer
   - TTL: `300` (5 –º–∏–Ω—É—Ç)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–º–µ–Ω –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:
   ```javascript
   const API_URL = 'https://api.yourdomain.com';
   ```

**–í–∞–∂–Ω–æ:**
- Load Balancer —Å–æ–∑–¥–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑ –≤—Ä—É—á–Ω—É—é** –≤ –∫–æ–Ω—Å–æ–ª–∏
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Instance Group Target Group –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç —Å–ø–∏—Å–æ–∫ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
- IP –∞–¥—Ä–µ—Å Load Balancer –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤

#### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—É–±–ª–∏—á–Ω—ã–π IP –Ω–∞ –∏–Ω—Å—Ç–∞–Ω—Å–∞—Ö

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
- ‚úÖ –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –∫–∞–∂–¥–æ–º—É –∏–Ω—Å—Ç–∞–Ω—Å—É

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- ‚ùå –ü—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ IP –º–µ–Ω—è–µ—Ç—Å—è
- ‚ùå –ù—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–Ω—Å—Ç–∞–Ω—Å –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

**–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:**

–í `.github/instance-group-spec.yaml` –¥–æ–±–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π IP:
```yaml
network_interface_specs:
  - network_id: {{ env.YC_NETWORK_ID }}
    subnet_ids:
      - {{ env.YC_SUBNET_ID }}
    primary_v4_address_spec:
      one_to_one_nat_spec:
        ip_version: IPV4
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:**
```javascript
// ‚ö†Ô∏è –ù—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å IP –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
const API_URL = 'http://<INSTANCE_PUBLIC_IP>:3333';
```

#### –í–∞—Ä–∏–∞–Ω—Ç 3: Application Load Balancer (–¥–ª—è HTTP/HTTPS)

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω HTTP/HTTPS –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π SSL:

1. Application Load Balancer ‚Üí –°–æ–∑–¥–∞—Ç—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTP/HTTPS listener
3. –ü—Ä–∏–≤—è–∑–∞—Ç—å Target Group –∫ Instance Group
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt –∏–ª–∏ —Å–≤–æ–π)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ Object Storage –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CORS:

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Express.js (Node.js):**
```javascript
const cors = require('cors');

app.use(cors({
  origin: [
    'https://storage.yandexcloud.net',
    'https://your-cdn-domain.com',
    'http://localhost:5173' // –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
  ],
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤:**

**NestJS:**
```typescript
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  
  app.enableCors({
    origin: [
      'https://storage.yandexcloud.net',
      'https://your-cdn-domain.com'
    ],
    credentials: true
  });
  
  await app.listen(3333);
}
```

**FastAPI (Python):**
```python
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "https://storage.yandexcloud.net",
        "https://your-cdn-domain.com"
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ API URL:**

```javascript
// config.js –∏–ª–∏ .env
const API_URL = process.env.VITE_API_URL || 'http://<LOAD_BALANCER_IP>:3333';

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
fetch(`${API_URL}/api/users`)
  .then(res => res.json())
  .then(data => console.log(data));
```

**–î–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π:**
```javascript
const API_URL = {
  development: 'http://localhost:3333',
  production: 'https://api.yourdomain.com'
}[process.env.NODE_ENV];
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Load Balancer
curl http://<LOAD_BALANCER_IP>:3333/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ CORS
curl -H "Origin: https://storage.yandexcloud.net" \
     -H "Access-Control-Request-Method: GET" \
     -H "Access-Control-Request-Headers: Content-Type" \
     -X OPTIONS \
     http://<LOAD_BALANCER_IP>:3333/api/users
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è production (—á–µ—Ä–µ–∑ Load Balancer —Å SSL)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall –ø—Ä–∞–≤–∏–ª–∞ (Security Groups)
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ API —Ç–æ–ª—å–∫–æ —Å –Ω—É–∂–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤ (—á–µ—Ä–µ–∑ CORS)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (JWT —Ç–æ–∫–µ–Ω—ã, API –∫–ª—é—á–∏)

---

## üìÅ –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –±–∞–∫–µ—Ç—ã:**

| –ë–∞–∫–µ—Ç | –¢–∏–ø –¥–æ—Å—Ç—É–ø–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-------------|------------|
| `mv-dating` | –ü—É–±–ª–∏—á–Ω—ã–π | –§—Ä–æ–Ω—Ç–µ–Ω–¥ (HTML, CSS, JS) |
| `mv-dating-uploads` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–∞–≤–∞—Ç–∞—Ä–∫–∏, —Ñ–æ—Ç–æ) |
| `mv-dating-media` | –ü—É–±–ª–∏—á–Ω—ã–π/–ü—Ä–∏–≤–∞—Ç–Ω—ã–π | –ö–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |

### –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∫–µ—Ç–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

**1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –±–∞–∫–µ—Ç:**
- –ò–º—è: `mv-dating-uploads`
- –¢–∏–ø –¥–æ—Å—Ç—É–ø–∞: **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 GB)

**2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞:**
- Service Account –±—ç–∫–µ–Ω–¥–∞: `storage.admin` –∏–ª–∏ `storage.uploader` –Ω–∞ –±–∞–∫–µ—Ç–µ

**3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:**
```
mv-dating-uploads/
  ‚îú‚îÄ‚îÄ avatars/{user-id}/avatar.jpg
  ‚îú‚îÄ‚îÄ photos/{user-id}/photo-1.jpg
  ‚îî‚îÄ‚îÄ documents/{user-id}/passport.pdf
```

### –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ –±—ç–∫–µ–Ω–¥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª ‚Üí –±—ç–∫–µ–Ω–¥ API
2. –ë—ç–∫–µ–Ω–¥ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –±–∞–∫–µ—Ç
3. –ë—ç–∫–µ–Ω–¥ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç presigned URL (–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
4. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç URL –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ñ–∞–π–ª

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ (Node.js):**
```javascript
// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
const uploadFile = async (file, userId, type) => {
  const fileName = `${type}/${userId}/${Date.now()}-${file.originalname}`;
  await yc.storage.object.put({
    bucket: 'mv-dating-uploads',
    key: fileName,
    body: file.buffer,
    contentType: file.mimetype
  });
  return fileName;
};

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è presigned URL
const getPresignedUrl = async (fileName, expiresIn = 3600) => {
  return await yc.storage.object.getPresignedUrl({
    bucket: 'mv-dating-uploads',
    key: fileName,
    expiresIn // URL –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 1 —á–∞—Å
  });
};
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä—è–º–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**

1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç presigned POST URL —É –±—ç–∫–µ–Ω–¥–∞
2. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é –≤ Object Storage
3. –§—Ä–æ–Ω—Ç–µ–Ω–¥ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –±—ç–∫–µ–Ω–¥ –æ–± —É—Å–ø–µ—à–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS (–¥–ª—è –ø—Ä—è–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏):**
- –ë–∞–∫–µ—Ç ‚Üí CORS
- Allowed Origins: `https://your-frontend-domain.com`
- Allowed Methods: `GET`, `PUT`, `POST`, `DELETE`

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ë–∞–∫–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–ø—Ä–∏–≤–∞—Ç–Ω—ã–º**
- ‚úÖ –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ **presigned URLs**
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üîß Troubleshooting

### –û—à–∏–±–∫–∞ "Permission denied"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ Service Account –Ω–∞ –Ω—É–∂–Ω–æ–º —Ä–µ—Å—É—Ä—Å–µ
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `YC_SA_JSON_CREDENTIALS` —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –û—à–∏–±–∫–∞ "Image not found"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `YC_REGISTRY` (—Ç–æ–ª—å–∫–æ ID, –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—Ä–∞–∑ —Å–æ–±—Ä–∞–Ω –∏ –∑–∞–ø—É—à–µ–Ω –≤ Container Registry

### –û—à–∏–±–∫–∞ "Bucket not found"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –±–∞–∫–µ—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–∞–∫–µ—Ç –≤ —Ç–æ–π –∂–µ –ø–∞–ø–∫–µ, —á—Ç–æ `YC_FOLDER_ID`

### –û—à–∏–±–∫–∞ 403 –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ —Ñ–∞–π–ª–∞–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∫–µ—Ç –∏–º–µ–µ—Ç **–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø** (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
- –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ presigned URLs

### –û—à–∏–±–∫–∞ "Dependencies lock file is not found"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `package-lock.json` –∑–∞–∫–æ–º–º–∏—á–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- Workflow –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `npm ci || npm install` –∫–∞–∫ fallback

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Yandex Cloud Console](https://console.cloud.yandex.ru/)
- [yc-coi-deploy-ig Action](https://github.com/yc-actions/yc-coi-deploy-ig)
- [yc-obj-storage-upload Action](https://github.com/yc-actions/yc-obj-storage-upload)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- Instance Group —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ
- –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ (`YC_FOLDER_ID`)
- Service Account –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å CDN –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
